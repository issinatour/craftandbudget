<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>craftandbudget</title>
<!-- 2015-06-05 Fri 16:39 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Nicolas Alphonse" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">craftandbudget</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. codeigniter librería SimpleLoginSecure</a></li>
<li><a href="#sec-2">2. Implementación de la bases de datos</a>
<ul>
<li><a href="#sec-2-1">2.1. Introducción a nuestra base de datos</a></li>
<li><a href="#sec-2-2">2.2. Tiendas</a></li>
<li><a href="#sec-2-3">2.3. Manejo de usuarios</a></li>
<li><a href="#sec-2-4">2.4. Multilenguaje</a></li>
<li><a href="#sec-2-5">2.5. Materiales</a></li>
<li><a href="#sec-2-6">2.6. Proveedores</a></li>
<li><a href="#sec-2-7">2.7. Productos</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> codeigniter librería SimpleLoginSecure</h2>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Implementación de la bases de datos</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Introducción a nuestra base de datos</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Se ha tratado de implementar una base de datos los más completa y
escalable posible. 
</p>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Tiendas</h3>
<div class="outline-text-3" id="text-2-2">
<p>
La aplicación va a ser multitienda. Un artesano puede usar a la
misma vez y de forma sincronizada diferentes tiendas online en
craft&amp;budget. Para ello, se ha creado la tabla "craftshop" en la
que se detallan los datos genéricos que el usuario quiere para
todas sus tiendas online. Cada tienda virtual se importará en la
tabla "shop". En ella se detalla información de esa tienda en
concreto, como el nombre de ésta, o el logo de la tienda. Para
conseguir que en una misma aplicación craft&amp;budget haya varias
tiendas se crea la tabla de relacion n-n "shop<sub>craftshop</sub>". En
cuanto a la tienda al que se conecta, como se puede apreciar en la
tabla "shop" se necesita almacenar el api key de la web a la que
pertence. Esta api key, permite privilegios CRUD en la base de
datos original usando la web api de prestsashop o de la tienda en
cuestión.
</p>

<p>
Se consigue así que los artesanos puedan utilizar craft&amp;shop para
  sincronizar todas sus tiendas online, y saber cuantos y que
  productos tienen online en cada tienda. Para esta situación cuando
  los usuarios sepan rápidamente de que tienda es cada producto, se ha
  decidido no solo especificar una columna para el nombre de la tienda
  virtual, sino que también se ha creado una columna para almacenar el
  logo de la tienda. Así, cuando el usuario este visualizando todos
  los productos que tiene a la venta, podrá saber a que tienda
  pertence cada uno solo con ver la imagen. 
</p>

<p>
Para relacionar cada producto del artesano con la tienda a la que
pertenece, se usan la tabla "types". Evitando así la duplicación de
datos del nombre de la tienda y del logo de esta. Como se puede ver
en la diagrama de la base de datos, la tabla "shop" hace referencia
al id de la tabla "types".
</p>
</div>
</div>



<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Manejo de usuarios</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Como se puede apreciar en el modelo, se ha dado la funcionalidad a
la app de que se puedan dar de alta varios usuarios a la vez en una
misma aplicación craft&amp;budget. La información básica de los usuarios
se encuentra en la tabla "user". Así mismo, los usuarios pueden tener
o un rol de administrador, o un rol de usuario normal. Los usuarios
con rol de administrador son los únicos usuarios que pueden importar
e exportar datos hacia las tiendas online. Los tipos de roles están
especificados en la talba "user<sub>rol</sub>". Finalmente, se ha creado una
tabla "craftshop<sub>users</sub>" en la que se relacionan un usuario de la
tabla "user", con un rol de usuario de la tabla "user<sub>rol</sub>" y con una
tienda de la tabla "shop".
</p>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Multilenguaje</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Se ha decidido también implementar una página multilenguaje para así
tener más usuarios potenciales. Para ello, se ha creado una tabla
"lang" en donde se especifica cada lenguaje que aceptará
craft&amp;shop. En esta tabla se insertarán todos los valores estándar
iso 639-2 de todos los lenguajes disponibles. Estos lenguajes están
escritos en tres columnas, una para el nombre del lenguaje, otra
para código numérico del lenguaje, y la última para el código
alfabético. Se relacionará cada usuario con un o varios
lenguajes. Para saber que lenguajes tiene disponible un usuario, se
usará la web api de prestashop, ya que en su base de datos se
almacena los lenguajes que tiene el usuario. La idea de implantar
está funcionalidad es que muchos artesanos traducen sus productos al
inglés o a otro idioma para conseguir más clientes. Desde prestashop
no es posible averiguar cuál es su lenguaje principal, así que se
optó por descargar todos sus productos en todos los lenguajes que
tenga especificado, y que sea el propio usuario quien eliga su
lenguaje a través de una pantalla de configuración. Se ha
considerado que las mejores partes en las incorporar multilenguaje
de nuestra aplicacón sea los productos, y los datos estáticos de la
página, es decir, los menús y mensajes de información. Los
materiales, y proveedores solo se almacenarán en la base de datos en
un solo lenguaje, debido a que nuestra app será un back office para los
artesanos, no un producto final para la vista de los clientes. Tiene
más sentido que la información insertada por el usuario se almacena
tan solo en un lenguaje, el lenguaje principal del usuario. La tabla
que se encargará de almacenar los diferentes lenguajes de cada
producto sera la tabla "product<sub>language</sub>". Esta tabla es la relación
n-n entre la tabla "product" y la tabla "lang". Un producto puede
estar traducido a muchos lenguajes, y un lenguaje puede estar siendo
usado en muchos productos. 
</p>
</div>
</div>


<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Materiales</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Los materiales se almacenarán en una tabla "materiales". Como se ha
dicho anteriormente, los materiales son los materias necesarias para
poder fabricar los productos de los artesanos. Estos materiales
tendrá que ser introducidos por los artesanos, ya que no existen en
las tiendas virtuales. Como nuestro sistema va a ser multiusuario
para una misma tienda craft&amp;budget, se ha optado por relacionar cada
material no con un usuario, pero con la tienda craft&amp;budget que
comparten todos los usuarios de una misma tienda. Para que los
artesanos puedan tener más organizado el stock de materiales, se ha
optado por relacionar a cada material con una categoría. La columna
"id<sub>category</sub>" de la tabla "material" hace referencia a la tabla
donde se guardan todas las categorías de la base de datos, en la
tabla "category". De esta manera, los usuarios podrán saber todos los
materiales disponibles de una categoría dada, y podrán buscar de
manera eficiente el stock de materiales. Esta última información se
encuentra en la tabla "stock<sub>material</sub>".
</p>

<p>
Los materiales no solo tiene la funcionalidad de especificar cuantos
materiales tiene un usuario, sino que también sirven para saber
cuantos materiales son necesarios para fabricar un producto.  La
tabla materiales representa los datos de los materiales, no el stock
que hay de dicho materia. Para hacer ello se ha decidido crear en la tabla
"materiales" un dato "id<sub>measurement</sub>", el cual hace referencia a la
tabla "measurement". En esta tabla lo que se almacena es el tipo de
medidas de los materiales, es decir si están especificados en kg, g,
l, metros cuadrados, etc&#x2026;  Para tener costancia de la cantidad de
cada material, se ha creado la tabla "stock<sub>material</sub>".
</p>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Proveedores</h3>
<div class="outline-text-3" id="text-2-6">
<p>
En cuanto a los proveedores, estos es almacenan en la tabla
"supplier". De estos se almacenará la dirección, y el nombre. Además
para saber que materiales tiene que proveedor, se ha creado la tabla
"material<sub>supplier</sub>". Es una relación n-n, en donde un material puede
ser comprado por varios proveedores. Lo hemos creído conveniente
hacerlo así, para dar la oportunidad a los artesanos a poder tener
en su base de datos varios proveedores para un mismo material, por
si en algún futuro alguno de sus proveedore falla.
</p>
</div>
</div>

<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> Productos</h3>
<div class="outline-text-3" id="text-2-7">
<p>
 En cuanto a los productos, estos se cogen directamente de la
tienda online del artesano. Se almacenarán en la tabla "product". Se
 ha decidido que cada producto solo puede ser de una tienda online. A
 pesar de que en la realidad se pueda tener un mismo producto
 publicitado en varias tienda, hemos considerado más adecuado que si
 son de tiendas separadas, el producto en nuestra bases de datos es
 diferente. Ya que podría darse el case de que el artesano quisiera
 diferentes precios dependiendo de la tienda.
</p>

<p>
Además también se almacena una imagen de cada material. En realidad,
según nuestra base de datos se podría almacenar más de una imagen,
pero ya que la imagen solo tiene sirve para facilitar la lectura de
productos desde las tablas, no para mostrar la mercancía a clientes,
se ha decidido que lo más conveniente es tan solo cargar la imagen
principal del producto desde prestashop. Se ha optado por no guardar
la imágen en formato binario en la base de datos, sino guardar el
nombre de la imagen desde la ruta relativa en nuestro sistema de
ficheros. Estas rutas se almacenarán en la tabla "product<sub>media</sub>" y 
todas las imágenes se guardarán en la carpeta assets/images. De está
manera, es mucho más fácil guardar imágenes, pues tan solo hay que
llamar a la libreria FileUpload de codeigniter, y este se encargá de
guardarlos en el sistema de ficheros, tan solo habría que almacenar
el string del nombre de la imagen.
</p>

<p>
Como es una aplicación destinada vendedores de artesanía, y los
productos que venden suelen estar hechos a medida, o al menos están
en varios colores, tamaños, materiales, etc&#x2026; Se ha implementado la
base de datos de manera que se pueda permitir a los artesanos poder
almacernar sus materiales y productos de forma dinámica. Para ellos,
se ha creado la tabla "combination", la que sirve como referencia
para determinar una variedad de un determinado producto. Por
ejemplo, si una mesa es XXL, si está pintada de color azul,
etc.. Esta combinación tendrá un stock y un precio. Para almacenar
en la base de datos las características de dicha combinación, hemos
creado otra tabla, la tabla "attributes". Finalmente, para
relacionar una combinación de un producto con un atributo
determinado, se ha creado la tabla "combination<sub>attribute</sub>".
</p>

<p>
Cabe destacar, que los materiales se relacionan con los productos,
no a través de la tablas "productos" y "materiales", sino a través
de la tabla "combinación", "materiales". Esto es así, porque
dependiendo de los atributos de un producto, este necesitará un tipo
de material u otro. Si tienes una mesa, y esta tiene el atributo
rojo; interesa relacionar el atributo "pintura roja para mesas" a la
combinación, y no al producto mesa.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nicolas Alphonse</p>
<p class="date">Created: 2015-06-05 Fri 16:39</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
